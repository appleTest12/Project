<html xmlns:th="http://www.thymeleaf.org">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<head>
    <meta charset="UTF-8">
    <title>게시물 작성폼</title>
	<script type="text/javascript" src="/js/com-ajax.js"></script>
</head>
<style>
    .layout {
        width: 500px;
        margin: 0 auto;
    }

    .layout input {
        width: 100%;
        box-sizing: border-box;
    }

    .layout textarea {
        width: 100%;
        margin-top: 10px;
        min-height: 300px;
    }
</style>
<script>
	// 페이지 온로드시 게시글 목록 조회
	window.onload = function () {
		fn_detail();
		const boardId = document.getElementById("boardId").value;
		document.getElementById('update_btn').setAttribute('href', "/modfiy?id="+boardId)
	}

	// 게시글 목록 조회
	function fn_detail() {
		const boardId = document.getElementById("boardId").value;
		const data = "?boardId="+boardId;
		AJAX.ajaxCall("GET", "/boards/detail", data, fn_Rtn);
	}
	
	function fn_Rtn(res){
		let element = document.querySelector("#fieldListBody");
		document.getElementById("title").value = res.content[0].title
		document.getElementById("content").value = res.content[0].content
	}
	
	function fn_dalete(){
		const boardId = document.getElementById("boardId").value;
		const data = "?boardId="+boardId;
		AJAX.ajaxCall("GET", "/boards/delete", data, fn_daleteRtn);
	}
	
	function fn_daleteRtn(res){
		if(res){
			alert("삭제되었습니다.");
			location.href="/board"
		} else {
			alert("실패하였습니다.");
		}
	}
</script>
<body>
    <div class="layout">
		<input type="hidden" id="boardId" th:value="${param.id}"/>
        <input name="title" id="title" type="text" readonly> <br>
        <textarea name="content" id="content" readonly></textarea> <br>
        <button><a id="update_btn">수정</a></button>
        <button onclick="fn_dalete()">삭제</button>
		<button><a type="submit" href="/board">뒤로가기</a></button>
    </div>

</body>
</html>